@if (IsVisible)
{
    <div class="delete-modal-overlay" @onclick="HandleCancel">
        <div class="delete-modal" @onclick:stopPropagation="true">
            <div class="delete-modal-header">
                <h2>Buch löschen?</h2>
            </div>

            <div class="delete-modal-content">
                <p class="book-title">@BookTitle</p>

                <div class="warning-box">
                    <p class="warning-title">Diese Aktion kann nicht rückgängig gemacht werden!</p>
                    <p class="warning-text">Folgende Daten werden ebenfalls gelöscht:</p>
                    <ul>
                        <li>Alle Lese-Sessions</li>
                        <li>Alle Zitate</li>
                        <li>Alle Annotationen</li>
                        <li>Genre-Zuordnungen</li>
                    </ul>
                </div>
            </div>

            <div class="delete-modal-actions">
                <button type="button" class="btn btn-danger" @onclick="HandleConfirm" disabled="@IsDeleting">
                    @if (IsDeleting)
                    {
                        <span>Löschen...</span>
                    }
                    else
                    {
                        <span>Endgültig löschen</span>
                    }
                </button>
                <button type="button" class="btn btn-secondary" @onclick="HandleCancel" disabled="@IsDeleting">
                    Abbrechen
                </button>
            </div>
        </div>
    </div>
}

@code {
    [Parameter] public bool IsVisible { get; set; }
    [Parameter] public string? BookTitle { get; set; }
    [Parameter] public bool IsDeleting { get; set; }
    [Parameter] public EventCallback OnConfirm { get; set; }
    [Parameter] public EventCallback OnCancel { get; set; }

    private async Task HandleConfirm()
    {
        await OnConfirm.InvokeAsync();
    }

    private async Task HandleCancel()
    {
        if (!IsDeleting)
        {
            await OnCancel.InvokeAsync();
        }
    }
}
